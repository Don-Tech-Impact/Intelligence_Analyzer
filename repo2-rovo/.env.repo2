# =============================================================================
# REPO 2 — Environment Variables (aligned with Repo 1 contract)
# =============================================================================
# Copy this file to .env in the repo root and fill in your values.
# CRITICAL: SECRET_KEY and ADMIN_KEY MUST match Repo 1's values exactly.
# =============================================================================

# ---------------------------------------------------------------------------
# Repo 1 Connection
# ---------------------------------------------------------------------------
# Primary name per integration contract:
REPO1_BASE_URL=http://host.docker.internal:8080
# Alias (Repo 2 code reads both; set both to be safe):
REPO1_URL=http://host.docker.internal:8080

# ---------------------------------------------------------------------------
# Redis — MUST be the same Redis instance as Repo 1
# Repo 1's Redis is at host.docker.internal:6379 (afric-analyzer-redis-local)
# ---------------------------------------------------------------------------
REDIS_URL=redis://host.docker.internal:6379/0

# ---------------------------------------------------------------------------
# Shared Secrets — MUST match Repo 1 exactly (share out-of-band)
# ---------------------------------------------------------------------------
# JWT signing secret (HS256). Never transmitted over HTTP.
SECRET_KEY=Fv2pkCopnlN9WkwjSjHWowOxjJfXSwdeOyDh_NLVaMNMcmL4uJTwPSwyz3XmMJZi

# Shared admin key for webhook receipt validation and service-to-service calls.
# Primary name per integration contract:
ADMIN_KEY=4BltQka5aJ_EHKPvdf0zP_7eEyR7aETtSxW5X-ZMqJMVszhcaWqgFcmPoPkLDGf7
# Alias (Repo 2 code reads both):
ADMIN_API_KEY=4BltQka5aJ_EHKPvdf0zP_7eEyR7aETtSxW5X-ZMqJMVszhcaWqgFcmPoPkLDGf7

# ---------------------------------------------------------------------------
# SuperAdmin credentials (for Repo 2 → Repo 1 JWT login fallback)
# ---------------------------------------------------------------------------
REPO1_ADMIN_EMAIL=superadmin@example.com
REPO1_ADMIN_PASSWORD=SuperAdmin123!

# ---------------------------------------------------------------------------
# Webhook — Repo 2 registers this URL with Repo 1
# Repo 1 will POST tenant lifecycle events here.
# ---------------------------------------------------------------------------
REPO2_WEBHOOK_URL=http://repo2-host:8000/api/admin/tenants/sync

# ---------------------------------------------------------------------------
# Database (Repo 2's own analytics database)
# ---------------------------------------------------------------------------
DATABASE_URL=postgresql://siem_user:siem_secure_password_2026@localhost:5432/siem_db
# For local dev without PostgreSQL:
# DATABASE_URL=sqlite:///./siem_local.db

# ---------------------------------------------------------------------------
# Application
# ---------------------------------------------------------------------------
LOG_LEVEL=INFO
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000

# ---------------------------------------------------------------------------
# Dead Letter Alert Threshold
# ---------------------------------------------------------------------------
# Alert when dead letter queue depth exceeds this value per tenant
DEAD_LETTER_ALERT_THRESHOLD=100

# ---------------------------------------------------------------------------
# Consumer tuning
# ---------------------------------------------------------------------------
BATCH_SIZE=100
BATCH_TIMEOUT_MS=1000
CONSUMER_REPLICAS=2

# ---------------------------------------------------------------------------
# Queue scan interval (seconds) — how often to check Redis for new tenants
# ---------------------------------------------------------------------------
REDIS_QUEUE_SCAN_INTERVAL=30
