<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Afric-Analyzer | Security Operations Center</title>
    <meta name="description" content="Afric-Analyzer — Real-time threat monitoring and security intelligence">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="ai-assistant.css">
    <script src="lucide.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>

<body>
    <div id="app">
        <!-- ===== Sidebar ===== -->
        <aside>
            <div class="logo">
                <div class="logo-icon">
                    <i data-lucide="shield"></i>
                </div>
                <span id="logo-text">Afric-Analyzer</span>
            </div>

            <ul class="nav-links">
                <li><a href="#" class="active" onclick="switchView('overview')"><i data-lucide="layout-dashboard"></i>
                        Dashboard</a></li>
                <li><a href="#" onclick="switchView('alerts')"><i data-lucide="shield-alert"></i> Threats</a></li>
                <li><a href="#" onclick="switchView('log-stream')"><i data-lucide="radio"></i> Live Stream</a></li>
                <li><a href="#" onclick="switchView('ai-assistant')"><i data-lucide="bot"></i> AI Assistant <span
                            class="badge-pro">PRO</span></a></li>
                <li><a href="#" onclick="switchView('analytics')"><i data-lucide="bar-chart-3"></i> Analytics</a></li>
                <li><a href="#" onclick="switchView('assets')"><i data-lucide="server"></i> Assets</a></li>
                <li><a href="#" onclick="switchView('compliance')"><i data-lucide="file-check"></i> Compliance</a></li>
                <li><a href="#" onclick="switchView('reports')"><i data-lucide="clipboard-list"></i> Reports</a></li>
                <li><a href="#" onclick="switchView('profile')"><i data-lucide="user-circle"></i> Profile</a></li>
                <li><a href="#" onclick="switchView('settings')"><i data-lucide="settings"></i> Settings</a></li>
            </ul>

            <div class="sidebar-bottom">
                <div class="api-status">
                    <span class="dot" id="api-status-dot"></span>
                    <span id="api-status-text">API Offline · Using mock data</span>
                </div>
                <div class="sidebar-user">
                    <div class="avatar">
                        <i data-lucide="user" style="width:14px;height:14px;"></i>
                    </div>
                    <div class="user-info">
                        <span class="name">Admin User</span>
                        <span class="email">admin@secureops.io</span>
                    </div>
                </div>
                <button class="logout-btn" onclick="Auth.logout()" style="margin-top: 12px;">
                    <i data-lucide="log-out"></i> Logout
                </button>
            </div>
        </aside>

        <!-- ===== Main Content ===== -->
        <main>
            <!-- Header -->
            <header>
                <div class="header-title">
                    <h1 id="view-title">Afric-Analyzer</h1>
                    <p id="view-subtitle">Real-time threat monitoring and response</p>
                </div>
                <div class="header-right">
                    <div class="status-badge offline" id="status-badge" onclick="toggleApiStatus()">
                        <i data-lucide="wifi-off"></i>
                        <span>Offline</span>
                    </div>

                    <div class="search-bar">
                        <i data-lucide="search"></i>
                        <input type="text" placeholder="Search threats, IPs, domains." id="global-search">
                    </div>

                    <div class="icon-btn" id="notification-btn">
                        <i data-lucide="bell" style="width:18px;height:18px;"></i>
                        <span class="notification-badge" id="notification-dot" style="display:none;"></span>
                    </div>

                    <div class="icon-btn">
                        <i data-lucide="settings" style="width:18px;height:18px;"></i>
                    </div>
                </div>
            </header>

            <div id="overview-view" class="dashboard-view active">
                <!-- AI Insight Strip (Relocated to Top) -->
                <div class="insights-pill" id="overview-insights-pill">
                    <i data-lucide="sparkles"></i>
                    <span id="ai-insight-text-overview">Analyzing signals...</span>
                </div>
                <!-- Stats Row -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon icon-teal"><i data-lucide="shield"></i></div>
                            <span class="trend up" id="trend-blocked">+12.5%</span>
                        </div>
                        <div class="stat-line"></div>
                        <div class="stat-body">
                            <h2 id="stats-total-logs">0</h2>
                            <p>Threats Blocked</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon icon-orange"><i data-lucide="alert-triangle"></i></div>
                            <span class="trend down" id="trend-incidents">-8.3%</span>
                        </div>
                        <div class="stat-line"></div>
                        <div class="stat-body">
                            <h2 id="stats-total-alerts">0</h2>
                            <p>Active Incidents</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon icon-purple"><i data-lucide="activity"></i></div>
                            <span class="trend up" id="trend-assets">+3.2%</span>
                        </div>
                        <div class="stat-line"></div>
                        <div class="stat-body">
                            <h2 id="stats-critical-high">0</h2>
                            <p>Monitored Assets</p>
                        </div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-header">
                            <div class="stat-icon icon-green"><i data-lucide="check-circle"></i></div>
                            <span class="trend up" id="trend-score">+2.1%</span>
                        </div>
                        <div class="stat-line"></div>
                        <div class="stat-body">
                            <h2 id="stats-active-threats">0</h2>
                            <p>Security Score</p>
                        </div>
                    </div>
                </div>

                <!-- Main Intelligence Row -->
                <div class="dashboard-grid-main">
                    <!-- Threat Activity Timeline -->
                    <div class="chart-container grid-span-2">
                        <div class="chart-header">
                            <div class="chart-header-left">
                                <h3>Threat Activity Timeline</h3>
                                <p>Incident density and volume trends</p>
                            </div>
                            <div class="chart-tabs">
                                <button class="active" onclick="setChartRange('24h')">24h</button>
                                <button onclick="setChartRange('7d')">7d</button>
                                <button onclick="setChartRange('30d')">30d</button>
                            </div>
                        </div>
                        <div id="volume-chart-main"></div>
                    </div>

                    <!-- Lateral Threat Intelligence -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <div class="chart-header-left">
                                <h3>Threat Vectors</h3>
                                <p>Top attack patterns</p>
                            </div>
                            <i data-lucide="shield-alert" class="icon-orange"></i>
                        </div>
                        <div id="threat-vectors-list" class="concise-list">
                            <!-- Populated by JS -->
                        </div>
                    </div>

                    <!-- Lateral Event Log -->
                    <div class="event-log-container">
                        <div class="event-log-header">
                            <div class="header-left">
                                <h3>Recent Events</h3>
                                <p>Live security findings</p>
                            </div>
                            <a href="#" class="view-all" onclick="switchView('logs')">View All</a>
                        </div>
                        <div id="event-log-list" class="concise-list">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>

                <!-- Secondary Intelligence Row -->
                <div class="dashboard-grid-secondary">
                    <!-- Source IPs / Protocols -->
                    <div class="chart-container grid-span-2">
                        <div class="chart-header">
                            <div class="chart-header-left">
                                <h3>Global Traffic Patterns</h3>
                                <p>Anomalous source origins</p>
                            </div>
                            <div class="bi-tabs">
                                <button id="tab-ips-main" class="active" onclick="toggleMainBIChart('ips')">Source
                                    IPs</button>
                                <button id="tab-proto-main" onclick="toggleMainBIChart('proto')">Protocols</button>
                            </div>
                        </div>
                        <div id="top-sources-chart-main"></div>
                        <div id="protocol-chart-main" style="display:none;"></div>
                    </div>

                    <!-- Business Intelligence -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <div class="chart-header-left">
                                <h3>Pattern Analysis</h3>
                                <p>Operational timeframe distribution</p>
                            </div>
                            <div class="bi-tabs">
                                <button id="tab-hours-main" class="active"
                                    onclick="toggleMainTimeChart('hours')">Hours</button>
                                <button id="tab-weekend-main" onclick="toggleMainTimeChart('weekend')">Weekend</button>
                            </div>
                        </div>
                        <div id="business-hours-chart-main"></div>
                        <div id="weekend-activity-chart-main" style="display:none;"></div>
                    </div>

                    <!-- Infrastructure Health -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <div class="chart-header-left">
                                <h3>Vendor Coverage</h3>
                                <p>Security logic distribution</p>
                            </div>
                            <i data-lucide="database" class="icon-indigo"></i>
                        </div>
                        <div id="vendor-breakdown-chart-main"></div>
                    </div>
                </div>

            </div>

            <!-- ============================================ -->
            <!-- ANALYTICS VIEW                               -->
            <!-- ============================================ -->
            <div id="analytics-view" class="dashboard-view">
                <div class="analytics-header">
                    <h2 class="section-title">Security & Traffic Analytics</h2>
                </div>

                <div class="analytics-grid">
                    <!-- Threat Activity Timeline (Moved from Overview) -->
                    <div class="chart-container grid-span-4">
                        <div class="chart-header">
                            <div class="chart-header-left">
                                <h3>Threat Activity Timeline</h3>
                                <p>Incident density and volume trends</p>
                            </div>
                            <div class="chart-tabs">
                                <button class="active" onclick="setChartRange('24h')">24h</button>
                                <button onclick="setChartRange('7d')">7d</button>
                                <button onclick="setChartRange('30d')">30d</button>
                            </div>
                        </div>
                        <div id="volume-chart-analytics"></div>
                    </div>

                    <div class="chart-container grid-span-2">
                        <div class="chart-header">
                            <h3>Source & Protocol Intelligence</h3>
                        </div>
                        <div class="bi-tabs">
                            <button id="tab-ips" class="active" onclick="toggleAnalyticsChart('ips')">Source
                                IPs</button>
                            <button id="tab-proto" onclick="toggleAnalyticsChart('proto')">Protocols</button>
                        </div>
                        <div id="sources-chart-container">
                            <div id="top-sources-chart"></div>
                            <div id="protocol-chart" style="display:none;"></div>
                        </div>
                    </div>

                    <div class="chart-container grid-span-2">
                        <div class="chart-header">
                            <h3>Infrastructure Breakdown</h3>
                        </div>
                        <div class="bi-tabs">
                            <button id="tab-vendor" class="active"
                                onclick="toggleAnalyticsChart('vendor')">Vendors</button>
                            <button id="tab-patterns" onclick="toggleAnalyticsChart('patterns')">Patterns</button>
                        </div>
                        <div id="infra-chart-container">
                            <div id="vendor-breakdown-chart"></div>
                            <div id="bi-chart-container" style="display:none;">
                                <div id="business-hours-chart"></div>
                                <div id="weekend-activity-chart" style="display:none;"></div>
                            </div>
                        </div>
                    </div>

                    <div class="chart-container grid-span-2">
                        <div class="chart-header">
                            <h3>Threat Landscape Heatmap</h3>
                            <p>Activity density by hour and day</p>
                        </div>
                        <div id="threat-heatmap"></div>
                    </div>

                    <div class="chart-container grid-span-2">
                        <div class="chart-header">
                            <h3>Compound Risk Trend</h3>
                            <p>Aggregated risk score over time</p>
                        </div>
                        <div id="risk-trend-chart"></div>
                    </div>

                    <!-- Vendor Comparison (Radar) -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <h3>Security Coverage</h3>
                            <p>Logic distribution by vendor</p>
                        </div>
                        <div id="vendor-radar-chart"></div>
                    </div>

                    <!-- Top Attack IPs (Modern List) -->
                    <div class="chart-container grid-span-1">
                        <div class="chart-header">
                            <h3>High-Risk Entities</h3>
                        </div>
                        <div id="high-risk-entities-list" class="concise-list">
                            <!-- Populated by JS -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- ASSETS (DEVICE MANAGEMENT) VIEW              -->
            <!-- ============================================ -->
            <div id="assets-view" class="dashboard-view">
                <div class="table-header" style="border-bottom:none; padding-bottom:0;">
                    <div class="header-left">
                        <h3>Asset Inventory</h3>
                        <p>Manage registered security devices and discover new assets</p>
                    </div>
                    <div class="table-filters" style="gap:15px;">
                        <button class="btn-primary" onclick="openRegisterDeviceModal()">
                            <i data-lucide="plus-circle"></i> Register Device
                        </button>
                    </div>
                </div>

                <!-- Asset Summary Row -->
                <div class="stats-grid" style="margin: 1.5rem 0; grid-template-columns: repeat(4, 1fr);">
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="label">Total Assets</span>
                            <i data-lucide="server" class="icon-blue"></i>
                        </div>
                        <div class="stat-value" id="asset-count-total">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="label">Active/Online</span>
                            <i data-lucide="zap" class="icon-green"></i>
                        </div>
                        <div class="stat-value" id="asset-count-online">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="label">Critical Threats</span>
                            <i data-lucide="alert-triangle" class="icon-orange"></i>
                        </div>
                        <div class="stat-value" id="asset-count-threats">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-header">
                            <span class="label">Unmanaged</span>
                            <i data-lucide="help-circle" class="icon-purple"></i>
                        </div>
                        <div class="stat-value" id="asset-count-unmanaged">0</div>
                    </div>
                </div>

                <div class="data-table-container">
                    <div class="table-header" style="background: rgba(148, 163, 184, 0.03);">
                        <div class="header-left">
                            <h4 style="font-size: 0.9rem; font-weight: 700;">Managed Security Devices</h4>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>IP Address</th>
                                <th>Category</th>
                                <th>Status</th>
                                <th>Last Activity</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="managed-assets-body"></tbody>
                    </table>
                </div>

                <div class="data-table-container">
                    <div class="table-header" style="background: rgba(148, 163, 184, 0.03);">
                        <div class="header-left">
                            <h4 style="font-size: 0.9rem; font-weight: 700;">Discovered (Unmanaged) Assets</h4>
                            <p>IPs detected in logs but not yet registered</p>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Source IP</th>
                                <th>Vendor/Type</th>
                                <th>Event Count</th>
                                <th>Threat Count</th>
                                <th>Last Seen</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="discovered-assets-body"></tbody>
                    </table>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- ALERTS (THREATS) VIEW                        -->
            <!-- ============================================ -->
            <div id="alerts-view" class="dashboard-view">
                <div class="data-table-container">
                    <div class="table-header">
                        <div class="header-left">
                            <h3>Security Alerts</h3>
                            <p>Active and historical security findings</p>
                        </div>
                        <div class="table-filters">
                            <div class="filter-group">
                                <i data-lucide="shield-alert" class="filter-icon"></i>
                                <select id="filter-severity" class="glass-input" onchange="fetchData()">
                                    <option value="">All Severities</option>
                                    <option value="critical">Critical</option>
                                    <option value="high">High</option>
                                    <option value="medium">Medium</option>
                                    <option value="low">Low</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Type</th>
                                <th>Source IP</th>
                                <th>Severity</th>
                                <th>Description</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="full-alerts-body"></tbody>
                    </table>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- COMPLIANCE VIEW (NEW)                        -->
            <!-- ============================================ -->
            <div id="compliance-view" class="dashboard-view">
                <div class="compliance-grid" id="compliance-cards">
                    <!-- Populated by JS -->
                </div>
            </div>

            <!-- ============================================ -->
            <!-- SETTINGS VIEW                                -->
            <!-- ============================================ -->
            <div id="settings-view" class="dashboard-view">
                <div class="settings-container">
                    <h3>Analyzer Configuration</h3>
                    <form id="settings-form" onsubmit="saveSettings(event)">
                        <div class="form-group">
                            <label>Brute Force Threshold</label>
                            <div class="input-wrapper">
                                <input type="number" id="bf-threshold" class="glass-input">
                                <span class="help-text">Failed logins before alert triggers</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Port Scan Threshold</label>
                            <div class="input-wrapper">
                                <input type="number" id="ps-threshold" class="glass-input">
                                <span class="help-text">Unique ports/min from single source</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>System Log Level</label>
                            <div class="input-wrapper">
                                <select id="log-level" class="glass-input">
                                    <option value="DEBUG">DEBUG</option>
                                    <option value="INFO">INFO</option>
                                    <option value="WARNING">WARNING</option>
                                    <option value="ERROR">ERROR</option>
                                </select>
                                <span class="help-text">Analyzer engine verbosity</span>
                            </div>
                        </div>
                        <div style="margin-top:1.5rem;display:flex;justify-content:flex-end;">
                            <button type="submit" class="btn-primary">Apply Changes</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- LOGS (INCIDENTS) VIEW                        -->
            <!-- ============================================ -->
            <div id="logs-view" class="dashboard-view">
                <div class="data-table-container">
                    <div class="table-header">
                        <div class="header-left">
                            <h3>Event Log Archive</h3>
                            <p>Full searchable history for tenant: <span class="tenant-tag"
                                    id="logs-tenant">default</span></p>
                        </div>
                        <div class="table-filters">
                            <div class="filter-group">
                                <i data-lucide="filter" class="filter-icon"></i>
                                <select id="log-filter-vendor" class="glass-input" onchange="fetchLogsData()">
                                    <option value="">All Vendors</option>
                                    <option value="pfsense">pfSense</option>
                                    <option value="ubiquiti_edge">Ubiquiti</option>
                                    <option value="cisco_meraki">Cisco</option>
                                </select>
                            </div>
                            <select id="log-filter-severity" class="glass-input" onchange="fetchLogsData()">
                                <option value="">All Severities</option>
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                            <div class="search-input-wrapper">
                                <i data-lucide="search"></i>
                                <input type="text" id="log-search" placeholder="Filter logs..." class="glass-input"
                                    oninput="fetchLogsData()">
                            </div>
                        </div>
                    </div>
                    <table class="mono-table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Type</th>
                                <th>Source</th>
                                <th>Destination</th>
                                <th>Proto</th>
                                <th>Action</th>
                                <th>Vendor</th>
                                <th>Device</th>
                                <th>Message</th>
                            </tr>
                        </thead>
                        <tbody id="full-logs-body">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- LIVE STREAM (RAW TELEMETRY) VIEW             -->
            <!-- ============================================ -->
            <div id="log-stream-view" class="dashboard-view">
                <div class="data-table-container">
                    <div class="table-header">
                        <h3>Live Traffic Stream</h3>
                        <div class="table-filters">
                            <span class="live-indicator"><span class="pulse"></span> STREAMING</span>
                        </div>
                    </div>
                    <div class="stream-console" id="log-stream-console">
                        <!-- Log lines added via JS -->
                    </div>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- AI ASSISTANT (PLAIN LANGUAGE) VIEW           -->
            <!-- ============================================ -->
            <div id="ai-assistant-view" class="dashboard-view">
                <div class="ai-assistant-container">
                    <div class="ai-chat-header">
                        <div class="ai-bot-info">
                            <div class="ai-bot-icon"><i data-lucide="bot"></i></div>
                            <div>
                                <h3>Security AI Assistant</h3>
                                <p>Plain language incident analysis and response</p>
                            </div>
                        </div>
                        <span class="badge-beta">PRO</span>
                    </div>

                    <div id="ai-messages" class="ai-messages-scroll">
                        <div class="message system">
                            Hello! I am your Security AI Assistant. I can help you analyze complex logs in plain
                            language, identify threat patterns, and suggest remediation steps.
                        </div>
                        <div id="ai-suggestions" class="ai-suggestions"
                            style="display:flex; gap:10px; padding:0 1.5rem 1rem; flex-wrap:wrap;">
                            <button class="badge-beta" style="cursor:pointer; border:1px solid var(--accent-blue);"
                                onclick="askAI('What is my current security risk level?')">What is my current risk
                                level?</button>
                            <button class="badge-beta" style="cursor:pointer; border:1px solid var(--accent-blue);"
                                onclick="askAI('Summarize the top threats from the last 24 hours.')">Summarize top
                                threats</button>
                            <button class="badge-beta" style="cursor:pointer; border:1px solid var(--accent-blue);"
                                onclick="askAI('How should I respond to the brute force attempts?')">How to fix brute
                                force?</button>
                        </div>
                    </div>

                    <div class="ai-input-area">
                        <input type="text" id="ai-input" placeholder="Ask about threats, logs, or analysis..."
                            class="glass-input" onkeypress="if(event.key==='Enter') sendAIMessage()">
                        <button class="btn-primary" onclick="sendAIMessage()"><i data-lucide="send"></i></button>
                    </div>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- REPORTS VIEW                                 -->
            <!-- ============================================ -->
            <div id="reports-view" class="dashboard-view">
                <div class="data-table-container">
                    <div class="table-header">
                        <!-- Generate Report Modal -->
                        <div id="gen-report-modal" class="modal-overlay"
                            style="display:none; position:fixed; inset:0; background:rgba(2,6,23,0.85); backdrop-filter:blur(8px); z-index:9999; padding:40px; align-items: center; justify-content: center;">
                            <div class="modal-content"
                                style="background: var(--bg-card); backdrop-filter: var(--glass-blur); border: 1px solid var(--glass-border); width:450px; border-radius:var(--radius-xl); display:flex; flex-direction:column; padding: 2.5rem; color: white; box-shadow: var(--shadow-elevated);">
                                <div
                                    style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 1.5rem;">
                                    <h3 style="margin:0;">Generate Security Report</h3>
                                    <button onclick="closeGenModal()"
                                        style="background:none; border:none; color:white; cursor:pointer;"><i
                                            data-lucide="x"></i></button>
                                </div>

                                <div class="form-group" style="margin-bottom: 1.25rem;">
                                    <label
                                        style="display:block; font-size: 0.75rem; color: var(--text-muted); text-transform:uppercase; margin-bottom: 0.5rem;">REPORT
                                        TYPE</label>
                                    <select id="gen-report-type" class="glass-input" style="width:100%;"
                                        onchange="toggleCustomDates()">
                                        <option value="daily">Daily Summary</option>
                                        <option value="weekly">Weekly Audit</option>
                                        <option value="monthly">Monthly Executive</option>
                                        <option value="custom">Custom Range</option>
                                    </select>
                                </div>

                                <div id="custom-date-section" style="display:none;">
                                    <div class="form-group" style="margin-bottom: 1.25rem;">
                                        <label
                                            style="display:block; font-size: 0.75rem; color: var(--text-muted); text-transform:uppercase; margin-bottom: 0.5rem;">START
                                            DATE</label>
                                        <input type="date" id="gen-report-start" class="glass-input"
                                            style="width:100%;">
                                    </div>
                                    <div class="form-group" style="margin-bottom: 1.25rem;">
                                        <label
                                            style="display:block; font-size: 0.75rem; color: var(--text-muted); text-transform:uppercase; margin-bottom: 0.5rem;">END
                                            DATE</label>
                                        <input type="date" id="gen-report-end" class="glass-input" style="width:100%;">
                                    </div>
                                </div>

                                <div style="margin-top: 1rem; display:flex; gap: 10px;">
                                    <button class="btn-primary" style="flex:1;" onclick="submitReportGeneration()">
                                        <i data-lucide="check" style="width:16px;height:16px;"></i> Generate
                                    </button>
                                    <button class="btn-secondary" style="flex:1;"
                                        onclick="closeGenModal()">Cancel</button>
                                </div>
                            </div>
                        </div>

                        <!-- Report Viewer Modal -->
                        <div id="report-modal" class="modal-overlay"
                            style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:9999; padding:40px;">
                            <button class="btn-primary" style="padding: 6px 12px; font-size: 12px;"
                                onclick="triggerReportGeneration()">
                                <i data-lucide="plus" style="width:14px;height:14px;"></i> Generate New
                            </button>
                            <select id="report-filter-type" class="glass-input" onchange="fetchReportsData()">
                                <option value="">All Types</option>
                                <option value="daily">Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly">Monthly</option>
                            </select>
                            <input type="date" id="report-filter-start" class="glass-input"
                                onchange="fetchReportsData()">
                            <input type="date" id="report-filter-end" class="glass-input" onchange="fetchReportsData()">
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Report Type</th>
                                <th>Generated</th>
                                <th>Period</th>
                                <th>Logs</th>
                                <th>Alerts</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="reports-table-body">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- PROFILE VIEW                                 -->
            <!-- ============================================ -->
            <div id="profile-view" class="dashboard-view">
                <div class="profile-container">
                    <div class="glass-card profile-card">
                        <div class="profile-header">
                            <div class="profile-avatar-large">
                                <i data-lucide="user"></i>
                            </div>
                            <div class="profile-title-group">
                                <h2 id="profile-name">Loading...</h2>
                                <p id="profile-email">email@example.com</p>
                            </div>
                            <div class="profile-badge" id="profile-role">Analyst</div>
                        </div>

                        <div class="profile-grid">
                            <div class="profile-info-group">
                                <label>Organization / Tenant</label>
                                <div class="profile-info-value" id="profile-tenant">default</div>
                            </div>
                            <div class="profile-info-group">
                                <label>Account Status</label>
                                <div class="profile-info-value"><span class="status-indicator online"></span> Active
                                </div>
                            </div>
                            <div class="profile-info-group">
                                <label>User Type</label>
                                <div class="profile-info-value" id="profile-type">Tenant User</div>
                            </div>
                            <div class="profile-info-group">
                                <label>Permissions</label>
                                <div class="profile-info-value" id="profile-permissions">Standard Access</div>
                            </div>
                        </div>

                        <div class="profile-actions">
                            <button class="btn-primary" onclick="showToast('Profile settings coming soon', false)">
                                <i data-lucide="edit-3"></i> Edit Profile
                            </button>
                            <button class="btn-secondary" onclick="Auth.logout()">
                                <i data-lucide="log-out"></i> Sign Out
                            </button>
                        </div>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- ============================================ -->
    <!-- REGISTER DEVICE MODAL                        -->
    <!-- ============================================ -->
    <div id="register-device-modal" class="modal" style="display:none;">
        <div class="modal-content glass-effect" style="width:500px;">
            <div class="modal-header"
                style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1.5rem;">
                <h3 style="margin:0;">Register Security Device</h3>
                <button onclick="closeRegisterDeviceModal()"
                    style="background:none; border:none; color:white; cursor:pointer;"><i data-lucide="x"></i></button>
            </div>
            <form id="register-device-form" onsubmit="submitRegisterDevice(event)">
                <div class="form-group" style="margin-bottom:1.25rem;">
                    <label
                        style="display:block; font-size:0.75rem; color:var(--text-muted); text-transform:uppercase; margin-bottom:0.5rem;">DEVICE
                        NAME</label>
                    <input type="text" id="reg-device-name" class="glass-input" style="width:100%;"
                        placeholder="e.g. London Firewall" required>
                </div>
                <div class="form-group" style="margin-bottom:1.25rem;">
                    <label
                        style="display:block; font-size:0.75rem; color:var(--text-muted); text-transform:uppercase; margin-bottom:0.5rem;">IP
                        ADDRESS / CIDR</label>
                    <input type="text" id="reg-device-ip" class="glass-input" style="width:100%;"
                        placeholder="e.g. 192.168.1.1" required>
                </div>
                <div class="form-group" style="margin-bottom:1.25rem;">
                    <label
                        style="display:block; font-size:0.75rem; color:var(--text-muted); text-transform:uppercase; margin-bottom:0.5rem;">CORRELATION
                        DEVICE ID (OPTIONAL)</label>
                    <input type="text" id="reg-device-id" class="glass-input" style="width:100%;"
                        placeholder="From logs/vendor system">
                </div>
                <div class="form-group" style="margin-bottom:1.25rem;">
                    <label
                        style="display:block; font-size:0.75rem; color:var(--text-muted); text-transform:uppercase; margin-bottom:0.5rem;">CATEGORY</label>
                    <select id="reg-device-category" class="glass-input" style="width:100%;">
                        <option value="firewall">Firewall</option>
                        <option value="switch">Switch</option>
                        <option value="server">Server</option>
                        <option value="endpoint">Endpoint</option>
                        <option value="waf">WAF</option>
                        <option value="other">Other</option>
                    </select>
                </div>
                <div class="form-group" style="margin-bottom:1.25rem;">
                    <label
                        style="display:block; font-size:0.75rem; color:var(--text-muted); text-transform:uppercase; margin-bottom:0.5rem;">DESCRIPTION</label>
                    <textarea id="reg-device-desc" class="glass-input" style="width:100%;" rows="3"></textarea>
                </div>
                <div style="margin-top:1.5rem; display:flex; gap:10px;">
                    <button type="submit" class="btn-primary" style="flex:1;">
                        <i data-lucide="check" style="width:16px;height:16px;"></i> Register & Allow
                    </button>
                    <button type="button" class="btn-secondary" style="flex:1;"
                        onclick="closeRegisterDeviceModal()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script src="auth.js"></script>
    <script src="app.js"></script>
    <script>lucide.createIcons();</script>
</body>

</html>