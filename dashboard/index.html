<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Afric-Analyzer | Security Operations Center</title>
    <meta name="description" content="Afric-Analyzer — Real-time threat monitoring and security intelligence">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="ai-assistant.css">
    <script src="lucide.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
</head>

<body>
    <div id="app">
        <!-- ===== Sidebar ===== -->
        <aside>
            <div class="logo">
                <div class="logo-icon">
                    <i data-lucide="shield-check" style="width:18px;height:18px;"></i>
                </div>
                <span>Afric-Analyzer</span>
            </div>

            <ul class="nav-links">
                <li><a href="#" class="active" onclick="switchView('overview')"><i data-lucide="layout-dashboard"></i>
                        Dashboard</a></li>
                <li><a href="#" onclick="switchView('alerts')"><i data-lucide="shield-alert"></i> Threats</a></li>
                <li><a href="#" onclick="switchView('log-stream')"><i data-lucide="radio"></i> Live Stream</a></li>
                <li><a href="#" onclick="switchView('ai-assistant')"><i data-lucide="bot"></i> AI Assistant <span
                            class="badge-pro">PRO</span></a></li>
                <li><a href="#" onclick="switchView('analytics')"><i data-lucide="bar-chart-3"></i> Analytics</a></li>
                <li><a href="#" onclick="switchView('compliance')"><i data-lucide="file-check"></i> Compliance</a></li>
                <li><a href="#" onclick="switchView('reports')"><i data-lucide="clipboard-list"></i> Reports</a></li>
                <li><a href="#" onclick="switchView('settings')"><i data-lucide="settings"></i> Settings</a></li>
            </ul>

            <div class="sidebar-bottom">
                <div class="api-status">
                    <span class="dot" id="api-status-dot"></span>
                    <span id="api-status-text">API Offline · Using mock data</span>
                </div>
                <div class="sidebar-user">
                    <div class="avatar">
                        <i data-lucide="user" style="width:14px;height:14px;"></i>
                    </div>
                    <div class="user-info">
                        <span class="name">Admin User</span>
                        <span class="email">admin@secureops.io</span>
                    </div>
                </div>
            </div>
        </aside>

        <!-- ===== Main Content ===== -->
        <main>
            <!-- Header -->
            <header>
                <div class="header-title">
                    <h1 id="view-title">Afric-Analyzer</h1>
                    <p id="view-subtitle">Real-time threat monitoring and response</p>
                </div>
                <div class="header-right">
                    <div class="status-badge offline" id="status-badge" onclick="toggleApiStatus()">
                        <i data-lucide="wifi-off"></i>
                        <span>Offline</span>
                    </div>

                    <div class="search-bar">
                        <i data-lucide="search"></i>
                        <input type="text" placeholder="Search threats, IPs, domains." id="global-search">
                    </div>

                    <div class="icon-btn" id="notification-btn">
                        <i data-lucide="bell" style="width:18px;height:18px;"></i>
                        <span class="notification-badge" id="notification-dot" style="display:none;"></span>
                    </div>

                    <div class="icon-btn">
                        <i data-lucide="settings" style="width:18px;height:18px;"></i>
                    </div>
                </div>
            </header>

            <!-- ============================================ -->
            <!-- OVERVIEW VIEW                                -->
            <!-- ============================================ -->
            <div id="overview-view" class="dashboard-view active">

                <!-- Stat Cards -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-top">
                            <div class="stat-icon-wrapper icon-teal">
                                <i data-lucide="shield" style="width:20px;height:20px;"></i>
                            </div>
                            <span class="trend up" id="trend-blocked"><i data-lucide="trending-up"></i> +12.5%</span>
                        </div>
                        <div class="stat-value" id="stats-total-logs">—</div>
                        <div class="stat-label">Threats Blocked</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-top">
                            <div class="stat-icon-wrapper icon-orange">
                                <i data-lucide="alert-triangle" style="width:20px;height:20px;"></i>
                            </div>
                            <span class="trend down" id="trend-incidents"><i data-lucide="trending-down"></i>
                                -8.3%</span>
                        </div>
                        <div class="stat-value" id="stats-total-alerts">—</div>
                        <div class="stat-label">Active Incidents</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-top">
                            <div class="stat-icon-wrapper icon-purple">
                                <i data-lucide="activity" style="width:20px;height:20px;"></i>
                            </div>
                            <span class="trend up" id="trend-assets"><i data-lucide="trending-up"></i> +3.2%</span>
                        </div>
                        <div class="stat-value" id="stats-critical-high">—</div>
                        <div class="stat-label">Monitored Assets</div>
                    </div>

                    <div class="stat-card">
                        <div class="stat-top">
                            <div class="stat-icon-wrapper icon-green">
                                <i data-lucide="check-circle" style="width:20px;height:20px;"></i>
                            </div>
                            <span class="trend up" id="trend-score"><i data-lucide="trending-up"></i> +2.1%</span>
                        </div>
                        <div class="stat-value" id="stats-active-threats">—</div>
                        <div class="stat-label">Security Score</div>
                    </div>
                </div>

                <!-- Charts Row -->
                <div class="charts-grid">
                    <!-- Threat Activity Timeline -->
                    <div class="chart-container">
                        <div class="chart-header">
                            <div class="chart-header-left">
                                <h3>Threat Activity Timeline</h3>
                                <p>Last 24 hours</p>
                            </div>
                            <div class="chart-tabs">
                                <button class="active" onclick="setChartRange('24h')">24h</button>
                                <button onclick="setChartRange('7d')">7d</button>
                                <button onclick="setChartRange('30d')">30d</button>
                            </div>
                        </div>
                        <div id="volume-chart"></div>
                    </div>

                    <!-- Top Threat Vectors -->
                    <div class="chart-container" style="min-height:auto;">
                        <div class="threat-vectors-header">
                            <div>
                                <h3>Top Threat Vectors</h3>
                                <p>Most common attacks</p>
                            </div>
                            <i data-lucide="alert-triangle" class="alert-icon"></i>
                        </div>
                        <div id="threat-vectors-list">
                            <!-- Populated by JS -->
                        </div>
                        <button class="btn-outline" onclick="switchView('alerts')">View All Threats</button>
                    </div>
                </div>

                <!-- Security Event Log -->
                <div class="event-log-container">
                    <div class="event-log-header">
                        <div>
                            <h3>Security Event Log</h3>
                            <p>Recent activity and alerts</p>
                        </div>
                        <a href="#" class="view-all" onclick="switchView('logs')">View All <i
                                data-lucide="external-link" style="width:12px;height:12px;"></i></a>
                    </div>
                    <div id="event-log-list">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- ALERTS (THREATS) VIEW                        -->
            <!-- ============================================ -->
            <div id="alerts-view" class="dashboard-view">
                <div class="data-table-container">
                    <div class="table-header">
                        <h3>Security Alerts</h3>
                        <div class="table-filters">
                            <select id="filter-severity" class="glass-input" onchange="fetchData()">
                                <option value="">All Severities</option>
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Type</th>
                                <th>Source IP</th>
                                <th>Severity</th>
                                <th>Description</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="full-alerts-body">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- ANALYTICS VIEW                               -->
            <!-- ============================================ -->
            <div id="analytics-view" class="dashboard-view">
                <div class="analytics-grid">
                    <div class="chart-container">
                        <div class="chart-header">
                            <div class="chart-header-left">
                                <h3>Top Source IPs</h3>
                            </div>
                        </div>
                        <div id="top-sources-chart"></div>
                    </div>
                    <div class="chart-container">
                        <div class="chart-header">
                            <div class="chart-header-left">
                                <h3>Protocol Distribution</h3>
                            </div>
                        </div>
                        <div id="protocol-chart"></div>
                    </div>
                </div>

                <h2 class="analytics-section-title">Business Intelligence</h2>
                <div class="analytics-grid">
                    <div class="chart-container">
                        <div class="chart-header">
                            <div class="chart-header-left">
                                <h3>Business vs After Hours</h3>
                            </div>
                        </div>
                        <div id="business-hours-chart"></div>
                        <p class="help-text" style="margin-top:0.75rem;text-align:center;">Office hours vs night-time
                            activity patterns</p>
                    </div>
                    <div class="chart-container">
                        <div class="chart-header">
                            <div class="chart-header-left">
                                <h3>Weekday vs Weekend</h3>
                            </div>
                        </div>
                        <div id="weekend-activity-chart"></div>
                        <p class="help-text" style="margin-top:0.75rem;text-align:center;">Detect anomalous weekend data
                            transfers</p>
                    </div>
                    <div class="chart-container">
                        <div class="chart-header">
                            <div class="chart-header-left">
                                <h3>Endpoint Breakdown</h3>
                            </div>
                        </div>
                        <div id="vendor-breakdown-chart"></div>
                        <p class="help-text" style="margin-top:0.75rem;text-align:center;">Contribution by device vendor
                        </p>
                    </div>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- COMPLIANCE VIEW (NEW)                        -->
            <!-- ============================================ -->
            <div id="compliance-view" class="dashboard-view">
                <div class="compliance-grid" id="compliance-cards">
                    <!-- Populated by JS -->
                </div>
            </div>

            <!-- ============================================ -->
            <!-- SETTINGS VIEW                                -->
            <!-- ============================================ -->
            <div id="settings-view" class="dashboard-view">
                <div class="settings-container">
                    <h3>Analyzer Configuration</h3>
                    <form id="settings-form" onsubmit="saveSettings(event)">
                        <div class="form-group">
                            <label>Brute Force Threshold</label>
                            <div class="input-wrapper">
                                <input type="number" id="bf-threshold" class="glass-input">
                                <span class="help-text">Failed logins before alert triggers</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Port Scan Threshold</label>
                            <div class="input-wrapper">
                                <input type="number" id="ps-threshold" class="glass-input">
                                <span class="help-text">Unique ports/min from single source</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>System Log Level</label>
                            <div class="input-wrapper">
                                <select id="log-level" class="glass-input">
                                    <option value="DEBUG">DEBUG</option>
                                    <option value="INFO">INFO</option>
                                    <option value="WARNING">WARNING</option>
                                    <option value="ERROR">ERROR</option>
                                </select>
                                <span class="help-text">Analyzer engine verbosity</span>
                            </div>
                        </div>
                        <div style="margin-top:1.5rem;display:flex;justify-content:flex-end;">
                            <button type="submit" class="btn-primary">Apply Changes</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- LOGS (INCIDENTS) VIEW                        -->
            <!-- ============================================ -->
            <div id="logs-view" class="dashboard-view">
                <div class="data-table-container">
                    <div class="table-header">
                        <h3>Event Log Archive</h3>
                        <div class="table-filters">
                            <select id="log-filter-vendor" class="glass-input" onchange="fetchLogsData()">
                                <option value="">All Vendors</option>
                                <option value="pfsense">pfSense</option>
                                <option value="ubiquiti_edge">Ubiquiti</option>
                                <option value="cisco_meraki">Cisco</option>
                            </select>
                            <select id="log-filter-severity" class="glass-input" onchange="fetchLogsData()">
                                <option value="">All Severities</option>
                                <option value="critical">Critical</option>
                                <option value="high">High</option>
                                <option value="medium">Medium</option>
                                <option value="low">Low</option>
                            </select>
                            <input type="text" id="log-search" placeholder="Search..." class="glass-input"
                                oninput="fetchLogsData()" style="width:160px;">
                        </div>
                    </div>
                    <table class="mono-table">
                        <thead>
                            <tr>
                                <th>Time</th>
                                <th>Type</th>
                                <th>Source</th>
                                <th>Destination</th>
                                <th>Proto</th>
                                <th>Action</th>
                                <th>Vendor</th>
                                <th>Device</th>
                                <th>Message</th>
                            </tr>
                        </thead>
                        <tbody id="full-logs-body">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- LIVE STREAM (RAW TELEMETRY) VIEW             -->
            <!-- ============================================ -->
            <div id="log-stream-view" class="dashboard-view">
                <div class="data-table-container">
                    <div class="table-header">
                        <h3>Live Traffic Stream</h3>
                        <div class="table-filters">
                            <span class="live-indicator"><span class="pulse"></span> STREAMING</span>
                        </div>
                    </div>
                    <div class="stream-console" id="log-stream-console">
                        <!-- Log lines added via JS -->
                    </div>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- AI ASSISTANT (PLAIN LANGUAGE) VIEW           -->
            <!-- ============================================ -->
            <div id="ai-assistant-view" class="dashboard-view">
                <div class="ai-assistant-container">
                    <div class="ai-chat-header">
                        <div class="ai-bot-info">
                            <div class="ai-bot-icon"><i data-lucide="bot"></i></div>
                            <div>
                                <h3>Security AI Assistant</h3>
                                <p>Plain language incident analysis and response</p>
                            </div>
                        </div>
                        <span class="badge-beta">PRO</span>
                    </div>

                    <div id="ai-messages" class="ai-messages-scroll">
                        <div class="message system">
                            Hello! I am your Security AI Assistant. I can help you analyze complex logs in plain
                            language, identify threat patterns, and suggest remediation steps.
                        </div>
                        <div id="ai-suggestions" class="ai-suggestions"
                            style="display:flex; gap:10px; padding:0 1.5rem 1rem; flex-wrap:wrap;">
                            <button class="badge-beta" style="cursor:pointer; border:1px solid var(--accent-blue);"
                                onclick="askAI('What is my current security risk level?')">What is my current risk
                                level?</button>
                            <button class="badge-beta" style="cursor:pointer; border:1px solid var(--accent-blue);"
                                onclick="askAI('Summarize the top threats from the last 24 hours.')">Summarize top
                                threats</button>
                            <button class="badge-beta" style="cursor:pointer; border:1px solid var(--accent-blue);"
                                onclick="askAI('How should I respond to the brute force attempts?')">How to fix brute
                                force?</button>
                        </div>
                    </div>

                    <div class="ai-input-area">
                        <input type="text" id="ai-input" placeholder="Ask about threats, logs, or analysis..."
                            class="glass-input" onkeypress="if(event.key==='Enter') sendAIMessage()">
                        <button class="btn-primary" onclick="sendAIMessage()"><i data-lucide="send"></i></button>
                    </div>
                </div>
            </div>

            <!-- ============================================ -->
            <!-- REPORTS VIEW                                 -->
            <!-- ============================================ -->
            <div id="reports-view" class="dashboard-view">
                <div class="data-table-container">
                    <div class="table-header">
                        <!-- Generate Report Modal -->
                        <div id="gen-report-modal" class="modal-overlay"
                            style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:9999; padding:40px; display: flex; align-items: center; justify-content: center;">
                            <div class="modal-content"
                                style="background:#0B1120; width:450px; border: 1px solid rgba(255,255,255,0.1); border-radius:12px; display:flex; flex-direction:column; padding: 2rem; color: white;">
                                <div
                                    style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 1.5rem;">
                                    <h3 style="margin:0;">Generate Security Report</h3>
                                    <button onclick="closeGenModal()"
                                        style="background:none; border:none; color:white; cursor:pointer;"><i
                                            data-lucide="x"></i></button>
                                </div>

                                <div class="form-group" style="margin-bottom: 1.25rem;">
                                    <label
                                        style="display:block; font-size: 0.75rem; color: var(--text-muted); text-transform:uppercase; margin-bottom: 0.5rem;">REPORT
                                        TYPE</label>
                                    <select id="gen-report-type" class="glass-input" style="width:100%;"
                                        onchange="toggleCustomDates()">
                                        <option value="daily">Daily Summary</option>
                                        <option value="weekly">Weekly Audit</option>
                                        <option value="monthly">Monthly Executive</option>
                                        <option value="custom">Custom Range</option>
                                    </select>
                                </div>

                                <div id="custom-date-section" style="display:none;">
                                    <div class="form-group" style="margin-bottom: 1.25rem;">
                                        <label
                                            style="display:block; font-size: 0.75rem; color: var(--text-muted); text-transform:uppercase; margin-bottom: 0.5rem;">START
                                            DATE</label>
                                        <input type="date" id="gen-report-start" class="glass-input"
                                            style="width:100%;">
                                    </div>
                                    <div class="form-group" style="margin-bottom: 1.25rem;">
                                        <label
                                            style="display:block; font-size: 0.75rem; color: var(--text-muted); text-transform:uppercase; margin-bottom: 0.5rem;">END
                                            DATE</label>
                                        <input type="date" id="gen-report-end" class="glass-input" style="width:100%;">
                                    </div>
                                </div>

                                <div style="margin-top: 1rem; display:flex; gap: 10px;">
                                    <button class="btn-primary" style="flex:1;" onclick="submitReportGeneration()">
                                        <i data-lucide="check" style="width:16px;height:16px;"></i> Generate
                                    </button>
                                    <button class="btn-secondary" style="flex:1;"
                                        onclick="closeGenModal()">Cancel</button>
                                </div>
                            </div>
                        </div>

                        <!-- Report Viewer Modal -->
                        <div id="report-modal" class="modal-overlay"
                            style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:9999; padding:40px;">
                            <button class="btn-primary" style="padding: 6px 12px; font-size: 12px;"
                                onclick="triggerReportGeneration()">
                                <i data-lucide="plus" style="width:14px;height:14px;"></i> Generate New
                            </button>
                            <select id="report-filter-type" class="glass-input" onchange="fetchReportsData()">
                                <option value="">All Types</option>
                                <option value="daily">Daily</option>
                                <option value="weekly">Weekly</option>
                                <option value="monthly">Monthly</option>
                            </select>
                            <input type="date" id="report-filter-start" class="glass-input"
                                onchange="fetchReportsData()">
                            <input type="date" id="report-filter-end" class="glass-input" onchange="fetchReportsData()">
                        </div>
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>Report Type</th>
                                <th>Generated</th>
                                <th>Period</th>
                                <th>Logs</th>
                                <th>Alerts</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="reports-table-body">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>

        </main>
    </div>

    <script src="auth.js"></script>
    <script src="app.js"></script>
    <script>lucide.createIcons();</script>
</body>

</html>