# Database Configuration
DATABASE_TYPE=sqlite  # sqlite or postgresql
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=siem_analyzer
DATABASE_USER=admin
DATABASE_PASSWORD=password

# Redis Configuration
REDIS_HOST=::1  # Use ::1 for IPv6-first stacks or 127.0.0.1 for IPv4
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_LOG_QUEUE=siem:logs
REDIS_ALERT_QUEUE=siem:alerts

# AWS Deployment Configuration
AWS_REGION=us-east-1
# ANALYZER_SECRET_KEY will be pulled from AWS Secrets Manager

# Email Configuration
EMAIL_ENABLED=false
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-password
SMTP_FROM=siem-alerts@company.com
SMTP_TO=security-team@company.com
SMTP_USE_TLS=true

# Threat Detection Thresholds
BRUTE_FORCE_THRESHOLD=5
BRUTE_FORCE_TIME_WINDOW=300  # seconds
PORT_SCAN_THRESHOLD=10
PORT_SCAN_TIME_WINDOW=60  # seconds

# Threat Intelligence
THREAT_INTEL_ENABLED=true
THREAT_INTEL_UPDATE_INTERVAL=3600  # seconds

# Reporting
REPORT_ENABLED=true
REPORT_SCHEDULE_CRON=0 9 * * *  # Daily at 9 AM
REPORT_EMAIL_TO=reports@company.com

# Logging
LOG_LEVEL=INFO
LOG_FILE=logs/siem_analyzer.log

# Multi-tenant Configuration
MULTI_TENANT_ENABLED=false
DEFAULT_TENANT=default

POSTGRES_PASSWORD=siem_secure_password_2026
SECRET_KEY=change-me-in-production
LOG_LEVEL=INFO
CONSUMER_REPLICAS=2

# ── Repo 1 Integration (Identity Provider) ─────────────────────────────────
# Base URL of Repo 1 — set to your production Repo 1 domain
REPO1_URL=https://your-repo1-domain.com

# Shared admin secret — MUST be byte-for-byte identical to Repo 1's ADMIN_KEY
# Generate: python -c "import secrets; print(secrets.token_urlsafe(48))"
ADMIN_KEY=changeme-admin-key

# Kept for backward compatibility — prefer ADMIN_KEY going forward
# ADMIN_API_KEY=changeme-admin-key


# Database: PostgreSQL with connection pooling
DATABASE_URL=postgresql://siem_user:${POSTGRES_PASSWORD:-siem_secure_password_2026}@postgres:5432/siem_db
SQLALCHEMY_POOL_SIZE=20
SQLALCHEMY_MAX_OVERFLOW=10
SQLALCHEMY_POOL_RECYCLE=1800
# Redis connection (pointing to host for external Redis)
REDIS_URL=${REDIS_URL:-redis://host.docker.internal:6379/0}
# Queue names (matching Repo1 output)
REDIS_DEAD_QUEUE=dead_logs
REDIS_INGEST_QUEUE=ingest_logs
REDIS_CLEAN_QUEUE=clean_logs
# Security
SECRET_KEY=${SECRET_KEY:-your-production-secret-key-change-me}
LOG_LEVEL=${LOG_LEVEL:-INFO}
ALLOWED_ORIGINS=${ALLOWED_ORIGINS:-http://localhost:8000}

# Worker settings
BATCH_SIZE=100
BATCH_TIMEOUT_MS=1000
LOG_LEVEL=${LOG_LEVEL:-INFO}